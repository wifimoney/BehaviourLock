# ðŸ”— BehaviorLock Integration Guide

Link your 4-agent Documentation Pipeline to **Codewords.AI**, **Cody**, and **Discord** for a seamless "Human in the Loop" workflow.

---

## 1. ðŸ¤– The Multi-Agent Pipeline
Your documentation is generated by 4 specialized agents:
1.  **Scanner**: Extracts signatures, side effects, and business logic hints.
2.  **Writer**: Drafts the technical README and function docs.
3.  **QA / Biz Logic**: Cross-references code to inject missing rules and fix inaccuracies.
4.  **Proofreader**: Tightens tone, formatting, and ensures consistency.

---

## 2. ðŸ“¡ Connecting Codewords.AI / Cody
To use B.LOC as a custom engine inside **Codewords** or **Cody**, create a new workflow and use these endpoints:

### **Trigger the Pipeline**
- **Method**: `POST`
- **URL**: `https://YOUR_NGROK_URL/docgen/run-direct`
- **Body**:
  ```json
  {
    "repo_path": "/path/to/your/code",
    "target_module": "optional_filename.py"
  }
  ```
- **Response**: Returns a `session_id` and a `preview`.

### **Fetch the Draft (for Review)**
- **Method**: `GET`
- **URL**: `https://YOUR_NGROK_URL/docgen/draft/<session_id>`

---

## 3. ðŸ’¬ Discord "Human in the Loop"
BehaviorLock automatically sends a message to your Discord once a draft is ready for review.

### **Setup**
1. Open `.env` and paste your Discord Webhook URL into `DISCORD_WEBHOOK_URL`.
2. Update `BASE_URL` to your public ngrok URL if testing remotely.

### **The Flow**
1. Pipeline finishes â†’ Discord ping with **QA Score** and **Preview**.
2. You review the draft via the links provided in Discord.
3. **Approve**: `POST /approve/<id> {"status": "approved"}`
   - *This triggers B.LOC to save the doc to its permanent memory.*
4. **Reject**: `POST /approve/<id> {"status": "rejected", "comment": "fix X"}`

---

## 4. ðŸ§  Memory Retrieval
External agents (like Cody) can query B.LOC's memory to get context on past migrations:
- `GET /memory/stats?repo_path=...`: Get learn stats.
- `GET /memory/search?query=fee+calculation`: Semantic search over repo logic.

---

## ðŸ’¡ Quick Start (Cody)
Paste the contents of `docgen_prompt.md` into Cody's workflow builder to automate this entire sequence.
